# EmailOperation_ExcelShell_Guide
## (EML Extraction Process)

- 본 문서는 특정 요청에 따라 특정 직원의 특정 기간 이메일 본문(EML)을 대량 다운로드 하고, 해당 파일을 엑셀 기반으로 검증하기 위한 절차를 정리했다. 
- 회사 정보 및 개인 정보는 보안을 위해 일반화 하여 작성하였다.

### 1. 배경
특정 직원의 특정 기간 동안의 이메일 본문이 필요한 경우가 있다. 이때 사내 메일 시스템의 EML 다운로드 기능을 이용해 수신/발신 이메일 리스트를 엑셀로 내려 받은 후 필요한 본문 파일을  EML 형식으로 다운로드 한다.

- 다운로드 개수는 요청된 리스트와 반드시 동일해야 하므로 검증 작업을 병행해야 한다. 
- 작업 전체는 다음 단계로 이루어진다. 

- 엑셀에서 이메일 본문 리스트 정리
- EML 파일 다운로드
- 다운로드 한 파일 수량 검증
- 파일명에서 날짜 추출 및 정렬
- 요청 리스트 대비 누락/중복 검증

### 2. 작업 단계

#### 2.1 엑셀 리스트 준비
- 메일 시스템에서 다음 조건으로 필터링하여 리스트를 다운로드한다. 
요청된 직원 ID(email) / 요청된 기간(연-월-일 단위 선택) / 제목 필터 (필요한 경우), 다운로드된 파일은 엑셀에서 본문 작업용 시트로 정리한다

#### 2.2 EML 다운로드
시트별 이름 (요청자 기준 또는 사번 기준)으로 폴더를 생성한다. 각 메일 본문을 하나씩 EML 파일로 다운로드 한다. 폴더 하단의 파일 개수를 확인하여 1차 검증한다.

#### 2.3 CMD 기반 파일 리스트 출력
다운로드 개수가 요청 수와 다르거나 검증이 필요한 경우 CMD에서 폴더 파일 리스트를 추출해 액셀로 비교한다.

예시 :
cd C:\Users\userName\Documents\EML_Download_Folder
dir /w > list.txt

생성된 list.txt를 열어 파일명을 복사하고 액셀의 새 시트에 붙여넣는다

#### 2.4 파일명에서 날짜 분리 및 정렬
파일명에는 보통 다음 구조가 포함된다. 
I20250805162433_메일제목.eml
O20250805132401_메일제목.eml

앞의 숫자 구간을 이용해 날짜와 시간으로 분리한다.

액셀 함수 예시:
=LEFT(A2, 15)
=MID(A2, 2, 14)
=DATE(LEFT(F2,4), MID(F2,5,2), MID(F2,7,2)) + TIME(MID(F2,9,2),MID(F2,11,2),MID(F213,2))
날짜 변환 후 내림차순(최신순)으로 정렬한다.

#### 2.5 검증 시트 작성
요청 리스트(원본)와 다운로드된 파일 리스트(정렬된 버전)을 대조한다.
수발신 날짜가 다르면 다운로드 오류 또는 누락으로 간주한다. 
파일명 중복(예 : 파일명(1).eml)이 있을 경우 재다운로드 필요하다.
모든 파일을 검증 후 최종적으로 요청 개수와 다운로드 개수가 일치해야 한다.

3. 엑셀에서 자주 사용되는 함수 모음






